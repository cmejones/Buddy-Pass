<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head') -%>
    <link
            rel="stylesheet"
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
            integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
            crossorigin="anonymous"
    />
    </head>
    <body>
    <!-- <form class="container-fluid" action="/profile/edit" method="POST"> -->
    <% if (user) { %>
        <form class="container-fluid">
        <div><input id="user" value="<%= user.id %>" /></div> <!--how to make this more dynamic??-->
            <label for="title">Title</label>
            <label>
            <input class="" type="text" name="title" id="title" autocomplete="off" />
            </label>


            <label for="department">Department</label>
            <label>
            <input class="" type="text" name="department" id="department" autocomplete="off" />
            </label>

            <label for="bio">Bio</label>
            <label>
                <input class="" type="text" name="bio" id="bio" autocomplete="off" />
            </label>


            <form>

            <button
                class="btn btn-primary"
                type="submit"
                onclick="submitProfileUpdate(event)"
            >
            save
            </button>
        </form>
 <% } %>
    <footer>
        <%- include('../partials/footer') -%>
    </footer>
    </body>
</html>

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<footer>
    <%- include('../partials/footer') -%>
</footer>

<script src="../../js/script.js"></script>


</body>
</html>


<script>
    function submitProfileUpdate(event) {
        console.log('you clicked me');
        event.preventDefault();
        let title_input = document.getElementById('title').value;
        let department_input = document.getElementById('department').value;
        let bio_input = document.getElementById('bio').value;
        let user_id = document.getElementById('user').value;

        let data = {
            title: title_input,
            department: department_input,
            bio: bio_input,
            user_id: user_id
        };
    console.log(data, 'this is my data');
    profileUpdate(data)
    .then(res => {
        // response was a success
        document.getElementById('title').value = '';
        document.getElementById('department').value = '';
        document.getElementById('bio').value = '';
        console.log('done!', res);
    })
    .catch(err => {
        // response failed
    });
    // return axios
    //     .patch('/api/edit-profile', data)
    //     .then(response => {
    //     console.log(response);
    // })
    //     .catch(err => {
    //         console.log(err);
    //     });
    }
</script>
